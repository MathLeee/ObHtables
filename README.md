# ObHtables - Obsidian HTML Table Editor Plugin

一个强大的 Obsidian 插件，用于直接编辑和管理 HTML 表格。

## 功能特性

### 🚀 核心功能
- **直接编辑 HTML 表格** - 在 Obsidian 中无缝编辑 HTML 表格
- **双击编辑功能** - 双击HTML表格即可快速进入编辑模式 ✅
- **智能表格识别** - 自动区分HTML表格和Markdown表格，仅对HTML表格启用双击编辑 ✅
- **右键快速插入** - 在编辑器中右键即可快速插入表格
- **可视化编辑器** - 直观的表格编辑界面
- **实时预览** - 编辑时实时查看表格效果
- **表格模板系统** - 丰富的预设模板，快速创建专业表格 ✅

### 📊 高级表格操作
- **单元格合并/拆分** - 支持 colspan 和 rowspan
- **智能行列操作** - 精确的行列插入、删除
- **批量操作** - 支持批量插入行列
- **单元格选择** - 多选单元格进行批量操作
- **表格数据排序** - 支持文本、数字、日期多种排序方式 ✅

### 🎨 用户体验
- **右键菜单** - 丰富的上下文菜单选项
- **快捷键支持** - 高效的键盘操作
- **复制粘贴** - 单元格内容的复制粘贴
- **主题支持** - 多种表格主题可选
- **模板管理** - 自定义模板保存和管理 ✅

## 安装方法

### 手动安装
1. 下载最新版本的插件文件
2. 将文件解压到 Obsidian vault 的 `.obsidian/plugins/ob-htables/` 目录
3. 在 Obsidian 设置中启用插件

### 开发者安装
```bash
# 克隆仓库
git clone https://github.com/MathLeee/ObHtables.git
cd ObHtables

# 安装依赖
npm install

# 开发模式
npm run dev

# 构建生产版本
npm run build
```

## 使用方法

### 快速开始
1. **插入新表格**：在编辑器中右键 → 选择"插入 HTML 表格"
2. **使用模板**：选择"从模板创建" → 选择合适的模板
3. **快速插入**：右键选择预设尺寸（2x2, 3x3, 4x4, 5x5）
4. **编辑现有表格**：
   - **双击编辑**：直接双击HTML表格即可进入编辑模式 ✨
   - **右键编辑**：选中 HTML 表格 → 右键 → "编辑 HTML 表格"

### 双击编辑功能 ✨

#### 功能特点
- **快速启动**：双击HTML表格即可立即进入编辑模式
- **智能识别**：自动区分HTML表格和Markdown表格
- **视觉反馈**：鼠标悬停时显示紫色边框提示可编辑
- **无干扰编辑**：隐藏Obsidian默认的表格选择框，提供纯净的编辑体验

#### 使用说明
1. **识别HTML表格**：插件会自动识别文档中的HTML表格
2. **悬停提示**：将鼠标移到HTML表格上会显示紫色边框
3. **双击编辑**：双击表格任意位置即可打开编辑器
4. **保存更改**：编辑完成后点击"应用更改"即可保存

#### 注意事项
- 仅HTML表格支持双击编辑，Markdown表格保持原生行为
- 如果遇到"无法定位表格位置"的提示，请使用手动替换功能
- 编辑时建议先备份重要数据

### 表格模板功能 ✨

#### 预设模板分类
- **基础模板**：简单的表格结构，适合一般用途
- **商务模板**：财务报表、项目时间线等商务场景
- **学术模板**：对比分析表、研究数据表等学术用途
- **个人模板**：日程安排、支出记录等个人管理

#### 模板使用方法
1. **选择模板**：点击"模板"按钮打开模板选择器
2. **浏览分类**：通过标签页浏览不同类别的模板
3. **预览模板**：每个模板都有实时预览
4. **应用模板**：点击模板卡片即可应用到当前表格

#### 自定义模板
1. **创建表格**：设计你的表格结构和内容
2. **保存模板**：点击"保存为模板"按钮
3. **填写信息**：输入模板名称、描述和分类
4. **管理模板**：在模板选择器中管理自定义模板

### 表格编辑功能
- **添加行列**：点击表格边缘的 + 按钮
- **删除行列**：右键选择删除选项
- **合并单元格**：选择多个单元格后右键合并
- **拆分单元格**：右键选择拆分选项
- **复制粘贴**：选择单元格后使用 Ctrl+C/Ctrl+V
- **数据排序**：选择列后使用排序按钮或右键菜单进行排序

### 排序功能详解

#### 排序类型
- **文本排序**：按字母顺序排序，支持中文
- **数字排序**：按数值大小排序，自动识别数字
- **日期排序**：按日期时间排序，支持多种日期格式

#### 排序方式
1. **控制面板排序**：
   - 选择要排序的列
   - 点击"升序排序"或"降序排序"按钮
   - 选择排序类型（文本/数字/日期）

2. **右键菜单排序**：
   - 右键点击要排序的列
   - 选择相应的排序选项
   - 支持快速文本排序和专门的数字/日期排序

#### 排序注意事项
- 如果表格包含表头，排序时会自动跳过第一行
- 包含合并单元格的列排序时会有提示确认
- 排序操作不可撤销，建议排序前备份重要数据

## 配置选项

在 Obsidian 设置 → 插件选项 → ObHtables 中可以配置：

- **默认表格行数**：新建表格的默认行数
- **默认表格列数**：新建表格的默认列数
- **启用表格样式**：是否应用自定义样式
- **表格主题**：选择表格外观主题
  - Default（默认）
  - Minimal（简约）
  - Bordered（边框）
  - Striped（条纹）
- **启用模板功能**：是否显示模板选择器 ✅
- **默认模板分类**：新建表格时的默认模板分类 ✅

## 技术栈

- **TypeScript** - 主要开发语言
- **Obsidian API** - 插件开发框架
- **ESBuild** - 构建工具
- **CSS3** - 样式设计

## 项目结构
ObHtables/
├── src/
│   ├── core/
│   │   ├── HtmlTableEditor.ts          # 主编辑器类（简化）
│   │   ├── TableData.ts                # 表格数据管理
│   │   └── TableRenderer.ts            # 表格渲染逻辑
│   ├── features/
│   │   ├── CellSelection.ts            # 单元格选择功能
│   │   ├── CellMerging.ts              # 单元格合并/拆分
│   │   ├── TableSorting.ts             # 表格排序功能
│   │   ├── TableTemplates.ts           # 表格模板系统 ✅
│   │   ├── RowColumnOperations.ts      # 行列操作（增删改）
│   │   └── ClipboardOperations.ts      # 复制粘贴功能
│   ├── ui/
│   │   ├── ControlPanel.ts             # 控制面板
│   │   ├── ContextMenu.ts              # 右键菜单
│   │   ├── TemplateSelector.ts         # 模板选择器 ✅
│   │   └── SortDialog.ts               # 排序对话框
│   ├── utils/
│   │   ├── TableParser.ts              # HTML表格解析 ✅
│   │   ├── TableValidator.ts           # 表格数据验证
│   │   └── EventHandlers.ts            # 事件处理工具
│   ├── types/
│   │   └── index.ts                    # 类型定义 ✅
│   ├── HtmlTableModal.ts               # 保持不变
│   └── index.ts                        # 导出入口
├── styles.css
└── main.ts

## 开发计划

- [x] 表格模板系统 ✅
- [ ] 导入/导出功能（CSV, Excel）
- [x] 表格数据排序 ✅
- [ ] 条件格式化
- [ ] 表格公式支持
- [ ] 协作编辑功能

## 更新日志

### v1.3.0 (2025-01-29)
- ✅ 新增HTML表格双击编辑功能
- ✅ 智能区分HTML表格和Markdown表格
- ✅ 优化表格悬停视觉效果，添加紫色边框提示
- ✅ 隐藏Obsidian默认表格选择框，提供无干扰编辑体验
- ✅ 改进表格定位和替换逻辑
- ✅ 修复表格编辑器中的样式显示问题
- ✅ 优化用户交互体验和错误处理

### v1.2.0 (2025-01-28)
- ✅ 新增表格模板系统
- ✅ 提供丰富的预设模板（基础、商务、学术、个人）
- ✅ 支持自定义模板保存和管理
- ✅ 模板分类浏览和实时预览
- ✅ 完善的模块化架构重构
- ✅ 新增 TableParser 工具类
- ✅ 优化用户界面和交互体验

### v1.1.0 (2025-07-27)
- ✅ 新增表格数据排序功能
- ✅ 支持文本、数字、日期三种排序类型
- ✅ 支持升序和降序排序
- ✅ 在控制面板和右键菜单中添加排序选项
- ✅ 优化合并单元格的排序处理
- ✅ 改进用户界面和交互体验

### v1.0.0 (2025-07-26)
- 🎉 初始版本发布
- ✅ 基础表格编辑功能
- ✅ 单元格合并/拆分
- ✅ 行列操作
- ✅ 右键菜单
- ✅ 复制粘贴功能

## 贡献指南

欢迎贡献代码！请遵循以下步骤：

1. Fork 本仓库
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 创建 Pull Request

## 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 支持

如果您觉得这个插件有用，请给个 ⭐️！

如有问题或建议，请在 [Issues](https://github.com/MathLeee/ObHtables/issues) 中提出。

---

**作者**: [MathLeee](https://github.com/MathLeee)  
**版本**: 1.3.0  
**更新时间**: 2025年7月29日